<!doctype html>
<html lang="en" class="theme-dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TalkKink — Kink Survey</title>

    <script>
      // hard reset flags that old code checks
      window.__TK_DISABLE_OVERLAY = true;
      window.__TK_DISABLE_PORTAL = true;
      window.__TK_DISABLE_DRAWER = true;

      // if a legacy boot still runs, neutralize its methods safely
      (function(){
        const noop = ()=>{};
        const g = window;
        const suspects = [
          'tkPanelBoot','tkPortalBoot','tkOverlayBoot',
          'tkDockLayout','tkLockPanel','tkOpenPanel','tkWirePanel'
        ];
        suspects.forEach(k => { if (k in g) g[k] = noop; });
        // remove any pre-existing overlay nodes if injected before this executes
        const killNodes = () => {
          document.querySelectorAll('#tkPortal,.tk-overlay,.tk-drawer,.tk-panel,.portal-overlay')
            .forEach(n => n.remove());
        };
        document.addEventListener('DOMContentLoaded', killNodes);
        new MutationObserver(killNodes).observe(document.documentElement,{childList:true,subtree:true});
      })();
    </script>

    <link rel="stylesheet" href="/assets/css/kinksurvey/survey.css?v=2025-10-15">
    <script defer src="/assets/js/kinksurvey/survey.js?v=2025-10-15"></script>
  </head>
  <body>
    <header id="tkHeader" class="header-grid">
      <!-- spacer that matches the fixed left panel width so title never overlaps -->
      <div class="header-spacer" aria-hidden="true"></div>

      <!-- centered title -->
      <h1 id="pageTitle" class="glow-title">TalkKink Survey</h1>

      <!-- theme controls (unchanged buttons) -->
      <div id="themeControls" class="theme-controls">
        <button class="theme-btn" data-theme="dark">Dark</button>
        <button class="theme-btn" data-theme="lipstick">Lipstick</button>
        <button class="theme-btn" data-theme="forest">Forest</button>
        <button class="theme-btn" data-theme="azure">Blue Glow</button>
      </div>
    </header>

    <!-- CTA stack (links to your other pages) -->
    <nav id="ctaStack" class="cta-stack" aria-label="Survey navigation">
      <button id="btnStart" class="cta primary" disabled title="Select at least one category to start">Start Survey</button>
      <a class="cta" href="/kinkanalysis/">Individual Kink Analysis</a>
      <a class="cta" href="/comparison/">Survey Partner Comparison</a>
    </nav>

    <aside id="categoryPanel" aria-label="Categories">
      <div class="panel-header">
        <h2>Categories</h2>
        <div id="selectedCountBadge" aria-live="polite">0 selected</div>
      </div>
      <div id="categoryChecklist" class="scroll"></div>
    </aside>

    <main id="surveyApp" class="is-hidden" aria-live="polite">
      <section id="controls">
        <div id="ndProgress">
          <div id="progressBar"><span id="progressPct">0%</span></div>
          <div id="progressText">Question 0 of 0</div>
        </div>
      </section>

      <section id="questionArea">
        <div id="roleTabs" role="tablist" aria-label="Roles">
          <button role="tab" data-role="Giving" aria-selected="true">Giving</button>
          <button role="tab" data-role="Receiving">Receiving</button>
          <button role="tab" data-role="General">General</button>
        </div>
        <article id="questionCard">
          <div id="questionPath" class="muted"></div>
          <h3 id="questionText"></h3>

          <div id="ratingRow" class="single">
            <div class="col">
              <div class="label">Rate interest/comfort (0–5)</div>
              <div class="scoreRow" data-partner="A"></div>
            </div>
          </div>

          <div id="navRow">
            <button id="prevBtn">Back</button>
            <button id="skipBtn">Skip</button>
            <button id="nextBtn">Next</button>
          </div>
        </article>
      </section>
    </main>
    <section id="exportPayload" hidden aria-hidden="true">
      <table id="compatibilityTable"></table>
    </section>
  </body>
</html>
