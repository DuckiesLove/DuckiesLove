<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PDF Download Test</title>
  <script src="https://unpkg.com/html2pdf.js@0.9.3/dist/html2pdf.bundle.min.js"></script>
</head>
<body>
  <button id="downloadBtn">Download PDF</button>

  <div id="pdf-container">
    <h1>PDF Export Test</h1>
    <table>
      <tbody>
        <tr><td>Cell 1</td><td>Cell 2</td></tr>
      </tbody>
    </table>
  </div>

  <script type="module">
    import { downloadCompatibilityPDF } from '/js/pdfDownload.js';
    window.downloadCompatibilityPDF = downloadCompatibilityPDF;
    function wire() {
      const btn = document.getElementById('downloadBtn') || document.querySelector('[data-download-pdf]');
      if (!btn) { console.error('[pdf] No download button found'); return; }
      const fresh = btn.cloneNode(true); btn.replaceWith(fresh);
      fresh.addEventListener('click', async () => {
        try { await downloadCompatibilityPDF(); }
        catch (e) { console.error(e); alert('Could not generate PDF. See console.'); }
      });
    }
    (document.readyState === 'loading') ? document.addEventListener('DOMContentLoaded', wire) : wire();
    console.log('[pdf] env', {
      html2pdf: !!window.html2pdf,
      html2canvas: !!window.html2canvas,
      jsPDF: !!(window.jspdf && window.jspdf.jsPDF),
      fn: typeof window.downloadCompatibilityPDF
    });
  </script>
</body>
</html>
