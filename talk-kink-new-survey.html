<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Talk Kink — Survey</title>
<style>
  :root{
    --bg:#000; --fg:#e6ffff; --accent:#00e6ff;
    --panelStart:#0f2834; --panelEnd:#0b1f27; --panelEdge:#23e0ff80;
    --row:#0a1820; --soft:#08161c; --line:#00e5ff44;
    --btn:#071a1f; --btnb:#00e6ff; --btnfg:#eaffff;
    --barBg:#062028; --barFill:#13e0ff;
    --ksv-panel-w:720px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

  /* WIDER PAGE */
  .wrap{max-width:1440px;margin:28px auto;padding:0 20px}

  h1{font-size:clamp(28px,5vw,48px);margin:0 0 18px 0;text-align:center}

  /* HERO BUTTONS (centered) */
  .hero{
    display:flex; flex-direction:column; align-items:center; gap:16px;
    margin:8px auto 22px; text-align:center;
  }
  .heroRow{display:flex; gap:16px; flex-wrap:wrap; justify-content:center}
  .btn{
    display:inline-block;padding:14px 22px;border:2px solid var(--btnb);
    border-radius:12px;background:var(--btn);color:var(--btnfg);
    cursor:pointer;font-weight:800;letter-spacing:.2px;transition:.15s
  }
  .btn[disabled]{opacity:.45;cursor:not-allowed}
  .btn:hover{transform:translateY(-1px)}
  .btn.xl{padding:16px 26px;font-size:1.05rem}
  /* Dockable action buttons */
  .ksv-btn{display:inline-flex;align-items:center;justify-content:center;text-align:center}
  #ksv-actions{
    display:flex;flex-direction:column;gap:20px;
    width:min(64ch,88vw);margin:32px auto 0;z-index:2;
  }
  body.tk-panel-open #categoryPanel{z-index:2147483500!important}
  body.tk-panel-open #ksv-actions.is-docked{
    position:fixed;
    left:calc(var(--ksv-panel-w) + 24px);
    right:24px;
    top:96px;
    max-width:360px;width:auto;margin:0;align-items:stretch;gap:14px;pointer-events:auto;
    z-index:2147483600!important;
  }
  body.tk-panel-open #ksv-actions.is-docked .ksv-btn{
    width:100%!important;max-width:none!important;margin:0!important;
    padding:12px 16px!important;border-radius:12px!important;
    font-size:clamp(14px,1.3vw,18px)!important;line-height:1.2;box-sizing:border-box;
  }
  .hero select{
    padding:12px 14px;border:2px solid var(--btnb);border-radius:12px;
    background:#05151a;color:var(--fg);font-weight:700
  }

  /* BIGGER, WIDER CATEGORY PANEL */
  .panel{
    border:1px solid var(--panelEdge);border-radius:18px;
    background:linear-gradient(180deg, var(--panelStart) 0%, var(--panelEnd) 100%);
    box-shadow:0 0 0 1px #00141a inset, 0 10px 28px #00121aa6;
    padding:16px;
    /* full width of the wide container */
    width:100%;
    max-height:78vh; overflow:auto; margin:0 auto;
  }
  .panelHeader{
    position:sticky; top:0; z-index:5; padding:10px 12px; margin:-16px -16px 12px;
    background:linear-gradient(180deg,#0d2b36 0%, #0c2028 100%);
    border-bottom:1px solid #00f0ff33; border-radius:18px 18px 0 0;
    display:flex; gap:12px; align-items:center; flex-wrap:wrap;
  }
  .status{opacity:.9; font-weight:700}

  .alphaGroup{margin:14px 0 18px}
  .alphaHeader{
    position:sticky; top:56px; z-index:2;
    padding:6px 10px; margin:0 0 10px 0; width:fit-content;
    background:#04222b; border:1px solid #0cf2ff33; border-radius:999px; font-weight:900; color:#90f7ff
  }
  /* MORE COLUMNS ON WIDE VIEW — panel fills the 1440px container */
  .alphaGrid{display:grid; gap:12px; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr));}
  .row{
    border:1px solid var(--line);border-radius:12px;background:var(--row);
    padding:12px 14px; transition:.12s box-shadow, .12s transform;
  }
  .row:hover{box-shadow:0 0 0 1px #00e5ff55; transform:translateY(-1px)}
  .row label{display:flex;align-items:center;gap:10px;cursor:pointer;font-weight:700}

  .notice{margin:14px 0;padding:10px 12px;border:1px dashed var(--line);border-radius:12px;background:#071317}
  .center{display:flex;justify-content:center;margin-top:10px}

  /* SURVEY */
  .survey{margin-top:24px;border:1px solid var(--line);border-radius:14px;background:var(--soft);padding:16px}
  .catTitle{margin:0 0 8px 0;color:#7ef9ff}
  .item{display:flex;align-items:center;gap:10px;padding:8px 0;border-top:1px dashed #00e5ff22}
  .item:first-child{border-top:0}
  select,input[type="text"]{
    padding:6px 8px;border:1px solid #144; border-radius:8px;background:#071820;color:var(--fg)
  }

  /* PROGRESS */
  .progress{
    margin:8px 0 16px 0; padding:10px 12px; border-radius:12px;
    background:linear-gradient(180deg,#0b2530 0%, #0b1e26 100%);
    border:1px solid #0cf2ff33;
  }
  .progressTop{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px;font-weight:700}
  .bar{height:12px;border-radius:999px;background:var(--barBg);overflow:hidden;border:1px solid #093642}
  .fill{height:100%;width:0%;background:linear-gradient(90deg,#08d7ff 0%, var(--barFill) 100%);box-shadow:0 0 6px #13e0ff}
  .counter{opacity:.95}
  a.home{color:var(--accent)}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Talk Kink — Survey</h1>

    <!-- HERO BUTTONS (center) -->
    <section class="hero" aria-label="Main actions">
      <div class="heroRow">
        <button class="btn xl" id="heroStart">Start Survey</button>
      </div>
      <div class="heroRow">
        <a class="btn" href="/compatibility/">Compatibility Page</a>
        <a class="btn" href="/ika/">Individual Kink Analysis</a>
      </div>
      <div class="heroRow" aria-label="Theme">
        <label style="display:flex;gap:10px;align-items:center">
          <span style="font-weight:800">Theme</span>
          <select id="themeSelect">
            <option value="dark" selected>Dark</option>
            <option value="lipstick">Lipstick</option>
            <option value="forest">Forest</option>
          </select>
        </label>
      </div>
    </section>

    <!-- WIDE CATEGORY PANEL -->
    <section class="panel" id="categoryPanel" aria-label="Category selection">
      <div class="panelHeader">
        <button class="btn" id="selectAll">Select All</button>
        <button class="btn" id="deselectAll">Deselect All</button>
        <span class="status" id="statusMsg">Loading categories…</span>
      </div>
      <div id="categoryList"></div>
      <div class="center">
        <button class="btn xl" id="startBtn" disabled>Start Survey</button>
      </div>
    </section>

    <div id="diag" class="notice" style="display:none"></div>

    <!-- SURVEY -->
    <section id="survey" class="survey" style="display:none">
      <div class="progress" role="group" aria-label="Progress">
        <div class="progressTop">
          <div class="counter" id="catCounter">Category 1 of 1</div>
          <div class="counter" id="qCounter">0 of 0 answered</div>
        </div>
        <div class="bar" aria-label="Questions progress">
          <div class="fill" id="qFill" style="width:0%" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"></div>
        </div>
      </div>

      <h2 class="catTitle" id="catTitle"></h2>
      <div id="items"></div>
      <div class="nav" style="margin-top:14px;display:flex;gap:12px;flex-wrap:wrap;justify-content:flex-end">
        <button class="btn" id="skipBtn">Skip Category</button>
        <button class="btn" id="nextBtn">Next Category</button>
      </div>
    </section>

    <section id="done" class="notice" style="display:none">
      <h3>Survey complete!</h3>
      <p>You’ve reached the end of the selected categories. <a class="home" href="/">Back to home</a></p>
    </section>
  </div>

<script>
(async function(){
  /* ---------- data fetch ---------- */
  const DATA_URLS = ['/data/kinks.json','/kinks.json','./data/kinks.json','./kinks.json'];

  const el = (id)=>document.getElementById(id);
  const $panel = el('categoryPanel');
  const $list  = el('categoryList');
  const $status= el('statusMsg');
  const $diag  = el('diag');
  const $heroStart = el('heroStart');
  const $start = el('startBtn');
  const $survey= el('survey');
  const $title = el('catTitle');
  const $items = el('items');
  const $done  = el('done');
  const $catCounter = el('catCounter');
  const $qCounter   = el('qCounter');
  const $qFill      = el('qFill');

  const state = { cats:[], sel:[], idx:0 };

  const tidy = (s)=>String(s??'').replace(/\s+/g,' ').trim();
  const looksHTML = (t)=>/^\s*<!doctype html/i.test(t)||/<html[\s>]/i.test(t);

  async function getData(){
    const errs=[];
    for (const u of DATA_URLS){
      try{
        const res = await fetch(u,{cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        const txt = await res.text();
        if (looksHTML(txt)) throw new Error('HTML fallback received');
        const j = JSON.parse(txt);
        return {json:j, src:u, errs};
      }catch(e){ errs.push(u+': '+e.message); }
    }
    throw new Error('All dataset fetches failed:\n- '+errs.join('\n- '));
  }

  function normalize(raw){
    const out = [];
    const push = (name, items)=>{
      const cat = tidy(name); if(!cat) return;
      const good=[];
      (items||[]).forEach(it=>{
        const id=tidy(it?.id||it?.key||it?.name||'');
        const label=tidy(it?.label||it?.text||'');
        const type=tidy(it?.type||'scale');
        if(id && label) good.push({id,label,type});
      });
      if(good.length) out.push({category:cat, items:good});
    };
    if (Array.isArray(raw)) raw.forEach(x=>push(x?.category ?? x?.name, x?.items));
    else if (raw && typeof raw==='object') Object.entries(raw).forEach(([k,v])=>push(k,v));
    return out;
  }

  /* ========== RENDER: WIDE, ALPHABETICAL PANEL ========== */
  function groupAlpha(cats){
    const grouped = new Map();
    cats.forEach(c=>{
      const ch = c.category.charAt(0).toUpperCase();
      const key = /[A-Z]/.test(ch) ? ch : '#';
      if(!grouped.has(key)) grouped.set(key, []);
      grouped.get(key).push(c);
    });
    for (const [, arr] of grouped) arr.sort((a,b)=>a.category.localeCompare(b.category,'en',{sensitivity:'base'}));
    const letters = Array.from(grouped.keys()).filter(l=>l!=='#').sort();
    if (grouped.has('#')) letters.push('#');
    return {grouped, letters};
  }

  function renderPanel(cats){
    $list.innerHTML='';
    const {grouped, letters} = groupAlpha(cats);
    letters.forEach(letter=>{
      const box = document.createElement('section'); box.className='alphaGroup';
      const h = document.createElement('div'); h.className='alphaHeader'; h.textContent = letter;
      const grid = document.createElement('div'); grid.className='alphaGrid';
      grouped.get(letter).forEach(c=>{
        const id='cb_'+Math.random().toString(36).slice(2,7);
        const row=document.createElement('div'); row.className='row'; row.setAttribute('role','listitem');
        row.innerHTML=`<label for="${id}"><input id="${id}" type="checkbox" value="${c.category}" checked> ${c.category}</label>`;
        grid.appendChild(row);
      });
      box.appendChild(h); box.appendChild(grid);
      $list.appendChild(box);
    });
    updateStart();
  }

  function selected(){
    return Array.from($list.querySelectorAll('input[type="checkbox"]')).filter(cb=>cb.checked).map(cb=>cb.value);
  }
  function updateStart(){
    const sel = selected().length;
    $start.disabled = sel===0;
    $status.textContent = `${sel} selected / ${state.cats.length} total`;
  }
  function showDiag(msg){ $diag.style.display='block'; $diag.textContent=msg; }

  /* ---------- per-category progress ---------- */
  function isAnswered(ctrl){
    if (ctrl.tagName === 'SELECT') return ['1','2','3','4','5'].includes(ctrl.value);
    if (ctrl.type === 'checkbox') return ctrl.checked === true;
    if (ctrl.type === 'text') return ctrl.value.trim().length > 0;
    return false;
  }
  function setupQProgress(controls){
    function update(){
      const total = controls.length;
      let answered = 0;
      controls.forEach(c => { if (isAnswered(c)) answered++; });
      $qCounter.textContent = `${answered} of ${total} answered`;
      const pct = total ? Math.round((answered/total)*100) : 0;
      $qFill.style.width = pct+'%';
      $qFill.setAttribute('aria-valuenow', pct);
    }
    controls.forEach(c => c.addEventListener('change', update));
    update();
  }

  function renderCategory(i){
    const c = state.sel[i];
    if(!c){ $survey.style.display='none'; $done.style.display='block'; return; }
    $done.style.display='none';
    $survey.style.display='block';
    $catCounter.textContent = `Category ${i+1} of ${state.sel.length}`;
    $title.textContent = c.category;
    $items.innerHTML='';
    c.items.forEach(it=>{
      const row=document.createElement('div'); row.className='item';
      const inputId='k_'+it.id;
      let node='';
      const t=(it.type||'').toLowerCase();
      if (t==='bool'){
        node = `<input type="checkbox" id="${inputId}" name="${it.id}">`;
      } else if (t==='text'){
        node = `<input type="text" id="${inputId}" name="${it.id}" placeholder="Your note">`;
      } else {
        node =
          `<select id="${inputId}" name="${it.id}">
             <option value="" selected hidden>–</option>
             <option value="1">1</option>
             <option value="2">2</option>
             <option value="3">3</option>
             <option value="4">4</option>
             <option value="5">5</option>
           </select>`;
      }
      row.innerHTML = `${node} <label for="${inputId}">${it.label}</label>`;
      $items.appendChild(row);
    });
    const controls = Array.from($items.querySelectorAll('select,input[type="checkbox"],input[type="text"]'));
    setupQProgress(controls);
  }

  /* ---------- bindings ---------- */
  $panel.addEventListener('change', (e)=>{
    if (e.target && e.target.matches('input[type="checkbox"]')) updateStart();
  });
  document.getElementById('selectAll').addEventListener('click', ()=>{
    $panel.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=true); updateStart();
  });
  document.getElementById('deselectAll').addEventListener('click', ()=>{
    $panel.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=false); updateStart();
  });

  // HERO start -> scroll to panel, focus Start button
  $heroStart.addEventListener('click', ()=>{
    $panel.scrollIntoView({behavior:'smooth', block:'start'});
    setTimeout(()=> $start.focus(), 400);
  });

  document.getElementById('startBtn').addEventListener('click', ()=>{
    const want = new Set(selected().map(s=>s.toLowerCase()));
    state.sel = state.cats
      .slice()
      .filter(c=>want.has(c.category.toLowerCase()))
      .sort((a,b)=>a.category.localeCompare(b.category,'en',{sensitivity:'base'})); // alphabetical in survey too
    state.idx = 0;
    if (!state.sel.length){ showDiag('No matching categories in dataset.'); return; }
    $panel.style.display='none';
    renderCategory(state.idx);
  });

  document.getElementById('skipBtn').addEventListener('click', ()=>{ state.idx++; renderCategory(state.idx); });
  document.getElementById('nextBtn').addEventListener('click', ()=>{ state.idx++; renderCategory(state.idx); });

  /* ---------- boot ---------- */
  try{
    const {json,src,errs} = await getData();
    state.cats = normalize(json);
    state.cats.sort((a,b)=>a.category.localeCompare(b.category,'en',{sensitivity:'base'}));
    renderPanel(state.cats);
    if (errs?.length) showDiag('Fetch notes:\n- ' + errs.join('\n- '));
  }catch(e){
    showDiag(e.message + '\nYou can still use this page once /data/kinks.json is published.');
    $status.textContent = 'Dataset unavailable';
  }
})();
</script>
<script>
(()=> {
  const SEL_PANEL  = '#categoryPanel, .category-panel, [data-panel="category"]';
  const SEL_SCRIM  = '#tkScrim, .tk-scrim, .drawer-scrim';
  const LABELS = [/^start\s+survey$/i,/^compatibility\s+page$/i,/^individual\s+kink\s+analysis$/i];

  function ensureActions(){
    let actions = document.getElementById('ksv-actions');
    if (!actions){
      const found = [...document.querySelectorAll('a,button')].filter(el=>{
        const t=(el.textContent||'').trim();
        return LABELS.some(rx=>rx.test(t)) && el.offsetParent !== null;
      });
      if (!found.length) return null;

      actions = document.createElement('nav');
      actions.id = 'ksv-actions';
      actions.setAttribute('aria-label','Survey actions');

      const host = document.querySelector('#ksvHeroStack')?.parentElement || found[0].parentElement || document.body;
      host.insertBefore(actions, found[0]);
      found.forEach(el => { el.classList.add('ksv-btn'); actions.appendChild(el); });
    }
    return actions;
  }

  const actions = ensureActions();
  if (!actions) return;

  const panel = document.querySelector(SEL_PANEL);
  const scrim = document.querySelector(SEL_SCRIM);

  const visible = el => el && el.offsetParent !== null;
  const isOpen  = () => document.body.classList.contains('tk-panel-open');

  function dock(){
    if (!(isOpen() && panel && visible(panel))){
      actions.classList.remove('is-docked');
      actions.style.top = '';
      return;
    }
    const r = panel.getBoundingClientRect();
    document.documentElement.style.setProperty('--ksv-panel-w', r.width + 'px');

    const available = window.innerWidth - r.width - 48;
    if (available < 220){
      actions.classList.remove('is-docked');
      actions.style.top = '';
      return;
    }
    const top = Math.max(72, r.top + 24 + window.scrollY);
    actions.style.top = top + 'px';
    actions.classList.add('is-docked');
  }

  if (scrim){
    const stop = e => { if (isOpen()){ e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation(); } };
    ['click','mousedown','touchstart'].forEach(ev => scrim.addEventListener(ev, stop, true));
  }
  window.addEventListener('keydown', e=>{
    if (isOpen() && (e.key === 'Escape' || e.keyCode === 27)){
      e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
    }
  }, true);

  const mo = new MutationObserver(dock);
  mo.observe(document.body, {attributes:true, attributeFilter:['class']});
  window.addEventListener('resize', dock);
  window.addEventListener('scroll', () => { if (isOpen()) dock(); }, {passive:true});

  dock();
})();
</script>
<script>
/* Talk Kink — minimal add-on:
   - Force survey to start with NO selections
   - Replace "Back to home" with "Download survey" that saves JSON
*/
(() => {
  /* ---------- small utilities ---------- */
  const toNum = v => {
    if (v == null || v === '') return 0;
    const n = Number(v);
    return Number.isFinite(n) ? n : 0;
  };
  const normText = n => (n || '').replace(/\s+/g,' ').trim().toLowerCase();

  // Try to produce a stable key for each control
  const keyFor = el => (
    el.dataset.kinkId ||
    el.name ||
    el.id ||
    (() => {
      let t = '';
      if (el.id) {
        const lbl = document.querySelector('label[for="'+CSS.escape(el.id)+'"]');
        if (lbl) t = (lbl.textContent||'').trim();
      }
      if (!t) {
        const cl = el.closest('label');
        if (cl) t = (cl.textContent||'').trim();
      }
      if (!t) t = el.getAttribute('aria-label') || el.placeholder || '';
      return t.replace(/\s+/g,'_').toLowerCase();
    })()
  );

  /* ---------- 1) Start with NO selections ---------- */
  function zeroAll() {
    // Sliders / numeric fields → 0
    document.querySelectorAll('input[type="range"], input[type="number"]').forEach(el => {
      if (String(el.value) !== '0') {
        el.value = 0;
        el.dispatchEvent(new Event('input',  {bubbles:true}));
        el.dispatchEvent(new Event('change', {bubbles:true}));
      }
    });

    // Selects → prefer blank option, else "0", else first option
    document.querySelectorAll('select').forEach(el => {
      const opts = [...el.options];
      if (opts.some(o => o.value === ''))      el.value = '';
      else if (opts.some(o => o.value === '0')) el.value = '0';
      else                                      el.selectedIndex = 0;
      el.dispatchEvent(new Event('change', {bubbles:true}));
    });

    // Checkboxes / radios → unchecked
    document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(el => {
      if (el.checked) {
        el.checked = false;
        el.dispatchEvent(new Event('change', {bubbles:true}));
      }
    });
  }

  // Run on load, plus two delayed passes (helps if UI renders async)
  function initZero() {
    zeroAll();
    setTimeout(zeroAll, 300);
    setTimeout(zeroAll, 1000);
  }

  /* ---------- 2) Collect answers → JSON ---------- */
  function collectResults() {
    const answers    = {};
    const byDataId   = {};
    const list       = [];

    document.querySelectorAll('input,select,textarea').forEach(el => {
      // Skip disabled or hidden-by-attr inputs
      if (el.disabled) return;

      const k = keyFor(el);
      if (!k) return;

      let v = 0;
      if (el.type === 'checkbox' || el.type === 'radio') {
        v = el.checked ? 1 : 0;
      } else if (el.tagName === 'SELECT') {
        v = toNum(el.value);
      } else if ('value' in el) {
        v = toNum(el.value);
      }

      answers[k] = v;

      const id = el.dataset.kinkId;
      if (id) byDataId[id] = v;

      list.push({ id: id || null, key: k, value: v });
    });

    return {
      meta: {
        source: 'talkkink.org/kinksurvey',
        generated_at: new Date().toISOString(),
        schema: 'tk-answers-v1'
      },
      answers,          // keyed by inferred key (name/id/label)
      byDataId,         // keyed by data-kink-id when present
      items: list       // array form (id, key, value)
    };
  }

  function downloadJSON(data) {
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    const stamp = new Date().toISOString().replace(/[:.]/g, '-');
    a.href = url;
    a.download = `talkkink-survey-${stamp}.json`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  /* ---------- 3) Replace "Back to home" with "Download survey" ---------- */
  function injectDownloadButton(root = document) {
    // Find a link whose text reads "Back to home"
    const links = [...root.querySelectorAll('a, button')];
    const tgt = links.find(el => normText(el.textContent).includes('back to home'));
    if (!tgt || tgt.dataset.tkDownloadInjected) return;

    // Build a replacement button; reuse existing classes for style
    const btn = document.createElement('a');
    btn.href = '#download';
    btn.textContent = 'Download survey';
    btn.setAttribute('role', 'button');
    btn.dataset.tkDownloadInjected = '1';

    // Copy classes so it looks the same as the original link
    if (tgt.className) btn.className = tgt.className;
    // If no classes at all, add a safe generic button look (optional)
    if (!btn.className) {
      btn.style.display = 'inline-block';
      btn.style.padding = '0.8rem 1.2rem';
      btn.style.border = '2px solid #00e6ff';
      btn.style.borderRadius = '12px';
      btn.style.color = '#00e6ff';
      btn.style.textDecoration = 'none';
      btn.style.fontWeight = '800';
    }

    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const data = collectResults();
      downloadJSON(data);
    });

    tgt.replaceWith(btn);
  }

  // Observe DOM so when the completion UI appears we swap the link
  const mo = new MutationObserver(muts => {
    for (const m of muts) {
      if (m.type === 'childList' && (m.addedNodes?.length || 0) > 0) {
        injectDownloadButton(document);
      }
    }
  });

  document.addEventListener('DOMContentLoaded', () => {
    initZero();
    injectDownloadButton(document); // in case it's already there
    mo.observe(document.body, { childList: true, subtree: true });
  });
})();
</script>
</body>
</html>
